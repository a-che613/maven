{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///Users/caasitech/Documents/dehor/maven-project/maven/src/app/api/checkout/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport nodemailer from \"nodemailer\";\nimport { cookies } from \"next/headers\";\n\nexport async function POST(request: Request) {\n  try {\n    const { userEmail, cart, total } = await request.json();\n\n    const transporter = nodemailer.createTransport({\n      host: \"smtp.zoho.com\",\n      port: 465,\n      secure: true,\n      auth: {\n        user: \"support@mavenrnvn.com\",\n        pass: \"9B466UMUziVU\", // temporary Zoho app password\n      },\n      tls: {\n        rejectUnauthorized: false,\n      },\n    });\n\n    // Format cart items for email\n    const cartItems = cart\n      .map(\n        (item: any) =>\n          `${item.quantity}x ${item.name} - $${item.price.toFixed(2)} each`\n      )\n      .join(\"\\n\");\n\n    // Send mail with defined transport object\n    let info = await transporter.sendMail({\n      from: '\"Maven Order System\" <noreply@maven.com>',\n      to: \"azienwi.che@gmail.com\",\n      subject: \"New Order Request\",\n      text: `New order request from: ${userEmail}\n\nItems Ordered:\n${cartItems}\n\nTotal: $${total.toFixed(2)}\n\nPlease contact the customer to complete the transaction.`,\n      html: `\n        <h1>New Order Request</h1>\n        <p><strong>Customer Email:</strong> ${userEmail}</p>\n        <h3>Items Ordered:</h3>\n        <ul>\n          ${cart\n            .map(\n              (item: any) =>\n                `<li>${item.quantity}x ${item.name} - $${item.price.toFixed(\n                  2\n                )} each</li>`\n            )\n            .join(\"\")}\n        </ul>\n        <h3>Total: $${total.toFixed(2)}</h3>\n        <p>Please contact the customer to complete the transaction.</p>\n      `,\n    });\n\n    console.log(\"Message sent: %s\", info.messageId);\n\n    // Clear the cart after successful checkout\n    const response = NextResponse.json({ success: true });\n    response.cookies.set(\"cart\", \"[]\", { path: \"/\" });\n    return response;\n\n    return NextResponse.json({ success: true });\n  } catch (error) {\n    console.error(\"Error sending email:\", error);\n    return NextResponse.json(\n      { error: \"Failed to process checkout\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,QAAQ,IAAI;QAErD,MAAM,cAAc,4JAAU,CAAC,eAAe,CAAC;YAC7C,MAAM;YACN,MAAM;YACN,QAAQ;YACR,MAAM;gBACJ,MAAM;gBACN,MAAM;YACR;YACA,KAAK;gBACH,oBAAoB;YACtB;QACF;QAEA,8BAA8B;QAC9B,MAAM,YAAY,KACf,GAAG,CACF,CAAC,OACC,GAAG,KAAK,QAAQ,CAAC,EAAE,EAAE,KAAK,IAAI,CAAC,IAAI,EAAE,KAAK,KAAK,CAAC,OAAO,CAAC,GAAG,KAAK,CAAC,EAEpE,IAAI,CAAC;QAER,0CAA0C;QAC1C,IAAI,OAAO,MAAM,YAAY,QAAQ,CAAC;YACpC,MAAM;YACN,IAAI;YACJ,SAAS;YACT,MAAM,CAAC,wBAAwB,EAAE,UAAU;;;AAGjD,EAAE,UAAU;;QAEJ,EAAE,MAAM,OAAO,CAAC,GAAG;;wDAE6B,CAAC;YACnD,MAAM,CAAC;;4CAE+B,EAAE,UAAU;;;UAG9C,EAAE,KACC,GAAG,CACF,CAAC,OACC,CAAC,IAAI,EAAE,KAAK,QAAQ,CAAC,EAAE,EAAE,KAAK,IAAI,CAAC,IAAI,EAAE,KAAK,KAAK,CAAC,OAAO,CACzD,GACA,UAAU,CAAC,EAEhB,IAAI,CAAC,IAAI;;oBAEF,EAAE,MAAM,OAAO,CAAC,GAAG;;MAEjC,CAAC;QACH;QAEA,QAAQ,GAAG,CAAC,oBAAoB,KAAK,SAAS;QAE9C,2CAA2C;QAC3C,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;QACnD,SAAS,OAAO,CAAC,GAAG,CAAC,QAAQ,MAAM;YAAE,MAAM;QAAI;QAC/C,OAAO;;;IAGT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAA6B,GACtC;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}